# d
NFC PROTOCOL SCYTHER
    随着智能设备的普及和无线通信技术的进步，移动支付逐渐成为主流支付方式。其中，基于NFC技术的近距离点对点支付方式由于其通信距离短、安全性更高、使用更加便利等优点，吸引了大多数智能手机厂商和行业关注，并在零售、公共出行等行业得到了广泛的应用。但基于NFC的支付方式存在一些安全威胁，一方面，由于NFC是一种无线通信手段，存在于开放的无线环境中，这使得它容易受到窃听、数据破坏和干扰攻击，另一方面，NFC技术本身没有提供任何安全机制来保护其通信，采用了应用程序级的加密来实现所有的加密安全，这导致用户的通信数据完全暴露于空气中。同时，用于保障支付安全的EMV协议也存在缺乏支付设备之间的相互认证和敏感数据不具备机密性的漏洞。针对这些安全威胁，研究人员进行了诸多研究工作，为了保障NFC支付的安全和顾客的隐私，设计了多种安全认证协议和隐私保护方案。
     注册阶段
     该阶段由用户发起，向注册机构（本方案为银行）提交自己的相关信息，如匿名标识符、用户账号信息等，注册机构返回一个与匿名标识符相关的对称私钥，用户进行处理后存入设备安全元件中。具体步骤如下：
    第一步：顾客生成一个椭圆曲线密钥对 ，然后生成注册信息 发送给银行，其中 是顾客自身的真实身份标识， 是顾客的私钥， 是顾客的匿名标识符， 是顾客的用户密码的哈希值，用户输入自身密码 之后，经由NFC的安全元件SE计算得到，同时SE会存储该值。 是银行的公钥。
    第二步：银行收到注册请求后，使用自身私钥 解密，使用 获得注册信息，保存 、 。生成一个共享对称密钥 并发送给注册用户。注册响应信息为 。获取到该共享密钥后，计算 ，存储在安全元件SE中。
    
